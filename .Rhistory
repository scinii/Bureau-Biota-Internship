setwd('C:\\Users\\rober\\Documents\\GitHub\\Bureau-Biota-Internship') # set working directory
source('utils.R')
library(adespatial)
library(vegan3d)
which_year = "Year 2024"
zoo_yearly <- read.xlsx(xlsxFile = "yearly_data.xlsx", sheet = which_year)
zoo_dataframes <- get_community_data(zoo_yearly, 'Family')
zoo_community <- zoo_dataframes[[1]]
zoo_spe <- zoo_dataframes[[2]]
zoo_env <- zoo_dataframes[[3]]
zoo_spat <- zoo_community[c('lat','lon','alt', 'Depth')]
zoo_env.z <- decostand(zoo_env, method = "standardize")
zoo_spe.hel <- decostand(zoo_spe, "hellinger")
informed_vars = zoo_env.z[c("Conductivity", "pH")]
distance_matrix = dist(zoo_spat)
moran = pcnm(distance_matrix)$vectors %>% as.data.frame()
rda(zoo_spe.hel, informed_vars, moran)
anova.cca(rda(zoo_spe.hel, informed_vars, moran))
plot(rda(zoo_spe.hel, informed_vars, moran))
